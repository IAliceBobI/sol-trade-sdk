# Command: execute
# Description: Execute development plan using plan executor
# Category: execution
# Version: 1
# Author: iFlow

description = "使用项目管理团队执行开发计划"

prompt = """
请使用 plan_executor agent 执行开发计划。

计划文件：{{args}}

请按照以下步骤执行：

1. **读取计划文件**：
   - 读取 {{args}} 文件
   - 理解计划内容和任务分解

2. **检查现有计划**：
   - 列出 .iflow/plans/ 目录下的所有计划
   - 如果有多个计划，使用 ask_user_question 询问用户要执行哪个计划

3. **创建 todo 列表**：
   - 根据计划中的任务分解创建 todo 列表
   - 使用 todo_write 工具创建
   - 每个 todo 包含：id、task（具体描述+文件路径）、status（pending）、priority

4. **按顺序执行任务**：
   - 按照 todo 列表的顺序执行任务
   - 标记任务状态：pending → in_progress → completed
   - 如果任务失败，标记为 failed 并分析原因

5. **更新 todo 状态**：
   - 使用 todo_write 工具实时更新任务状态
   - 确保进度可视化

6. **验证完成结果**：
   - 每个任务完成后进行验证
   - 检查功能是否正常
   - 检查代码质量是否达标
   - 检查是否符合验证标准

7. **生成执行报告**：
   - 完成的任务列表
   - 失败的任务及原因
   - 遇到的问题和解决方案
   - 下一步行动计划

输出格式参考：
```
## 执行计划：{计划名称}

### 计划概览
- 任务总数：N
- 阶段数：M
- 预计时间：X

### Todo 列表已创建
- 任务1：{描述} [pending]
- 任务2：{描述} [pending]
...

开始执行...

### 执行进度

阶段1：{阶段名称}
- 任务1.1：✅ 已完成
- 任务1.2：🔄 进行中
- 任务1.3：⏳ 待处理

阶段2：{阶段名称}
- 任务2.1：⏳ 待处理
...

### 执行完成

### 完成情况
- 总任务数：N
- 已完成：M
- 失败：K
- 进行中：L

### 完成的任务
1. 任务1：{描述} ✅
2. 任务2：{描述} ✅
...

### 失败的任务
1. 任务X：{描述} ❌
   - 原因：{原因}
   - 建议：{建议}

### 遇到的问题
- 问题1：{描述} - 解决方案：{方案}

### 下一步行动
- 建议1：{描述}
- 建议2：{描述}
```

注意事项：
- 按优先级执行任务（high > medium > low）
- 注意任务之间的依赖关系
- 如果任务失败，记录原因并寻求解决方案
- 遇到不确定的情况时，使用 ask_user_question 询问用户
"""

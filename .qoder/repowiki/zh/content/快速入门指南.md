# å¿«é€Ÿå…¥é—¨æŒ‡å—

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**  
- [Cargo.toml](file://Cargo.toml)
- [README.md](file://README.md)
- [examples/cli_trading/src/main.rs](file://examples/cli_trading/src/main.rs)
- [examples/trading_client/src/main.rs](file://examples/trading_client/src/main.rs)
- [src/lib.rs](file://src/lib.rs)
- [docs/TRADING_PARAMETERS.md](file://docs/TRADING_PARAMETERS.md)
- [docs/GAS_FEE_STRATEGY.md](file://docs/GAS_FEE_STRATEGY.md)
- [examples/cli_trading/README.md](file://examples/cli_trading/README.md)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [æ·»åŠ ä¾èµ–](#æ·»åŠ ä¾èµ–)
3. [åˆå§‹åŒ–TradingClient](#åˆå§‹åŒ–tradingclient)
4. [æ‰§è¡Œäº¤æ˜“](#æ‰§è¡Œäº¤æ˜“)
5. [å…³é”®é…ç½®é¡¹](#å…³é”®é…ç½®é¡¹)
6. [å¸¸è§é”™è¯¯æ’æŸ¥](#å¸¸è§é”™è¯¯æ’æŸ¥)
7. [å®Œæ•´ç¤ºä¾‹æµç¨‹](#å®Œæ•´ç¤ºä¾‹æµç¨‹)

## ç®€ä»‹

sol-trade-sdk æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Rust SDKï¼Œç”¨äºåœ¨ Solana åŒºå—é“¾ä¸Šä¸å¤šä¸ªå»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼ˆDEXï¼‰è¿›è¡Œäº¤äº’ã€‚æœ¬æŒ‡å—å°†æŒ‡å¯¼å¼€å‘è€…åœ¨ 5 åˆ†é’Ÿå†…å®Œæˆ SDK çš„é›†æˆå¹¶æ‰§è¡Œç¬¬ä¸€ç¬”äº¤æ˜“ã€‚

è¯¥ SDK æ”¯æŒ PumpFunã€PumpSwapã€Bonkã€Raydium å’Œ Meteora ç­‰å¤šç§ DEX çš„äº¤æ˜“åŠŸèƒ½ï¼Œæä¾›ç»Ÿä¸€çš„äº¤æ˜“æ¥å£å’Œå¼ºå¤§çš„ä¸­é—´ä»¶ç³»ç»Ÿã€‚é€šè¿‡æœ¬æŒ‡å—ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•å¿«é€Ÿè®¾ç½®é¡¹ç›®ã€åˆå§‹åŒ–äº¤æ˜“å®¢æˆ·ç«¯å¹¶æ‰§è¡ŒåŸºæœ¬çš„ä¹°å–æ“ä½œã€‚

**Section sources**
- [README.md](file://README.md#L1-L321)

## æ·»åŠ ä¾èµ–

è¦å°† sol-trade-sdk é›†æˆåˆ°æ‚¨çš„ Rust é¡¹ç›®ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ·»åŠ ä¾èµ–ï¼šç›´æ¥å…‹éš†ä»“åº“æˆ–ä½¿ç”¨ crates.ioã€‚

### ä½¿ç”¨ crates.ioï¼ˆæ¨èï¼‰

åœ¨æ‚¨çš„ `Cargo.toml` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š

```toml
[dependencies]
sol-trade-sdk = "3.3.6"
```

### ç›´æ¥å…‹éš†ä»“åº“

å¦‚æœæ‚¨å¸Œæœ›ä»æºç è¿›è¡Œå¼€å‘æˆ–è°ƒè¯•ï¼Œå¯ä»¥å…‹éš†æ•´ä¸ªé¡¹ç›®ï¼š

```bash
cd your_project_root_directory
git clone https://github.com/0xfnzero/sol-trade-sdk
```

ç„¶ååœ¨ `Cargo.toml` ä¸­æ·»åŠ è·¯å¾„ä¾èµ–ï¼š

```toml
[dependencies]
sol-trade-sdk = { path = "./sol-trade-sdk", version = "3.3.6" }
```

**Section sources**
- [Cargo.toml](file://Cargo.toml#L1-L142)
- [README.md](file://README.md#L75-L98)

## åˆå§‹åŒ–TradingClient

`TradingClient` æ˜¯ SDK çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†äº¤æ˜“ã€RPC è¿æ¥å’Œç­¾åã€‚ä»¥ä¸‹æ˜¯åˆå§‹åŒ– `TradingClient` æ‰€éœ€çš„æœ€å°é…ç½®ã€‚

### åŸºæœ¬é…ç½®æ­¥éª¤

1. **è®¾ç½®é’±åŒ…å¯†é’¥**ï¼šä½¿ç”¨æ‚¨çš„ç§é’¥åˆ›å»º `Keypair` å®ä¾‹
2. **é…ç½® RPC URL**ï¼šæŒ‡å®š Solana ç½‘ç»œçš„ RPC ç«¯ç‚¹
3. **è®¾ç½®äº¤æ˜“é…ç½®**ï¼šåˆ›å»º `TradeConfig` å®ä¾‹
4. **åˆ›å»ºå®¢æˆ·ç«¯å®ä¾‹**ï¼šä½¿ç”¨ä¸Šè¿°é…ç½®åˆå§‹åŒ– `TradingClient`

### æœ€å°é…ç½®ç¤ºä¾‹

```rust
use solana_sdk::signature::Keypair;
use solana_commitment_config::CommitmentConfig;
use sol_trade_sdk::{SwqosConfig, TradeConfig, SolanaTrade};
use std::sync::Arc;

// 1. è®¾ç½®é’±åŒ…ï¼ˆä½¿ç”¨æ‚¨çš„ç§é’¥ï¼‰
let payer = Keypair::from_base58_string("your_private_key_here");

// 2. è®¾ç½® RPC URL
let rpc_url = "https://mainnet.helius-rpc.com/?api-key=your_api_key".to_string();
let commitment = CommitmentConfig::processed();

// 3. é…ç½® SWQOS æœåŠ¡ï¼ˆå¯é€‰ä½†æ¨èï¼‰
let swqos_configs: Vec<SwqosConfig> = vec![
    SwqosConfig::Default(rpc_url.clone()),
    // å¯ä»¥æ·»åŠ  Jitoã€Bloxroute ç­‰ MEV ä¿æŠ¤æœåŠ¡
];

// 4. åˆ›å»ºäº¤æ˜“é…ç½®
let trade_config = TradeConfig::new(rpc_url, swqos_configs, commitment);

// 5. åˆ›å»º TradingClient å®ä¾‹
let client = SolanaTrade::new(Arc::new(payer), trade_config).await;
```

**Section sources**
- [examples/trading_client/src/main.rs](file://examples/trading_client/src/main.rs#L10-L41)
- [src/lib.rs](file://src/lib.rs#L49-L298)

## æ‰§è¡Œäº¤æ˜“

ä¸€æ—¦ `TradingClient` åˆå§‹åŒ–å®Œæˆï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨ `buy()` å’Œ `sell()` æ–¹æ³•æ‰§è¡Œäº¤æ˜“ã€‚

### è°ƒç”¨ buy() æ–¹æ³•

```rust
use sol_trade_sdk::{TradeBuyParams, DexType, TradeTokenType};
use solana_sdk::pubkey::Pubkey;

// 1. å‡†å¤‡äº¤æ˜“å‚æ•°
let buy_params = TradeBuyParams {
    dex_type: DexType::PumpFun,
    input_token_type: TradeTokenType::SOL,
    mint: Pubkey::from_str("token_mint_address").unwrap(),
    input_token_amount: 100000000, // 0.1 SOL (ä»¥ lamports ä¸ºå•ä½)
    slippage_basis_points: Some(500), // 5% æ»‘ç‚¹
    recent_blockhash: None,
    extension_params: DexParamEnum::PumpFun(pumpfun_params),
    address_lookup_table_account: None,
    wait_transaction_confirmed: true,
    create_input_token_ata: false,
    close_input_token_ata: false,
    create_mint_ata: true,
    durable_nonce: None,
    fixed_output_token_amount: None,
    gas_fee_strategy: gas_fee_strategy,
    simulate: false,
};

// 2. æ‰§è¡Œè´­ä¹°
match client.buy(buy_params).await {
    Ok((success, signatures, error)) => {
        if success {
            println!("âœ… äº¤æ˜“æˆåŠŸ! äº¤æ˜“ç­¾å: {:?}", signatures);
        } else {
            println!("âŒ äº¤æ˜“å¤±è´¥: {:?}", error);
        }
    }
    Err(e) => {
        println!("âŒ äº¤æ˜“é”™è¯¯: {}", e);
    }
}
```

### è°ƒç”¨ sell() æ–¹æ³•

```rust
use sol_trade_sdk::TradeSellParams;

// 1. å‡†å¤‡å–å‡ºå‚æ•°
let sell_params = TradeSellParams {
    dex_type: DexType::PumpFun,
    output_token_type: TradeTokenType::SOL,
    mint: Pubkey::from_str("token_mint_address").unwrap(),
    input_token_amount: 1000000000, // è¦å–å‡ºçš„ä»£å¸æ•°é‡
    slippage_basis_points: Some(500),
    recent_blockhash: None,
    with_tip: true,
    extension_params: DexParamEnum::PumpFun(pumpfun_params),
    address_lookup_table_account: None,
    wait_transaction_confirmed: true,
    create_output_token_ata: true,
    close_output_token_ata: false,
    close_mint_token_ata: false,
    durable_nonce: None,
    fixed_output_token_amount: None,
    gas_fee_strategy: gas_fee_strategy,
    simulate: false,
};

// 2. æ‰§è¡Œå–å‡º
match client.sell(sell_params).await {
    Ok((success, signatures, error)) => {
        if success {
            println!("âœ… å–å‡ºæˆåŠŸ! äº¤æ˜“ç­¾å: {:?}", signatures);
        } else {
            println!("âŒ å–å‡ºå¤±è´¥: {:?}", error);
        }
    }
    Err(e) => {
        println!("âŒ å–å‡ºé”™è¯¯: {}", e);
    }
}
```

**Section sources**
- [src/lib.rs](file://src/lib.rs#L344-L572)
- [examples/cli_trading/src/main.rs](file://examples/cli_trading/src/main.rs#L617-L647)

## å…³é”®é…ç½®é¡¹

### TradeConfig é»˜è®¤å€¼

`TradeConfig` æ˜¯äº¤æ˜“çš„æ ¸å¿ƒé…ç½®ç»“æ„ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®é…ç½®é¡¹ï¼š

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|-------|------|
| `create_wsol_ata_on_startup` | true | å¯åŠ¨æ—¶æ£€æŸ¥å¹¶åˆ›å»º WSOL å…³è”ä»£å¸è´¦æˆ· |
| `use_seed_optimize` | true | å…¨å±€å¯ç”¨ç§å­ä¼˜åŒ–ç”¨äºæ‰€æœ‰ ATA æ“ä½œ |
| `commitment` | processed | RPC æäº¤çº§åˆ« |

### Gas Fee Strategy

Gas è´¹ç”¨ç­–ç•¥ç”¨äºæ§åˆ¶äº¤æ˜“è´¹ç”¨å’Œä¼˜å…ˆçº§ï¼š

```rust
// åˆ›å»º GasFeeStrategy å®ä¾‹
let gas_fee_strategy = sol_trade_sdk::common::GasFeeStrategy::new();

// è®¾ç½®å…¨å±€ç­–ç•¥
gas_fee_strategy.set_global_fee_strategy(
    150000, // cu_limit
    150000, // cu_price
    500000, // cu_price_sell
    500000, // cu_price_buy
    0.001,  // tip
    0.001,  // tip_sell
    256 * 1024, // data_size_limit
    0       // min_priority_fee
);
```

**Section sources**
- [docs/TRADING_PARAMETERS.md](file://docs/TRADING_PARAMETERS.md#L1-L188)
- [docs/GAS_FEE_STRATEGY.md](file://docs/GAS_FEE_STRATEGY.md#L1-L90)

## å¸¸è§é”™è¯¯æ’æŸ¥

### ç½‘ç»œè¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼š`Failed to create RPC client` æˆ– `Network error`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ RPC URL æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸
3. å°è¯•æ›´æ¢ä¸åŒçš„ RPC æä¾›å•†ï¼ˆå¦‚ Heliusã€QuickNodeï¼‰
4. æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æœ‰æ•ˆ

### ç­¾åé”™è¯¯

**ç—‡çŠ¶**ï¼š`Signature verification failed` æˆ– `Invalid private key`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ç§é’¥æ ¼å¼æ­£ç¡®ï¼ˆBase58 å­—ç¬¦ä¸²ï¼‰
2. æ£€æŸ¥é’±åŒ…æ˜¯å¦æœ‰è¶³å¤Ÿçš„ SOL ä½™é¢æ”¯ä»˜äº¤æ˜“è´¹ç”¨
3. ç¡®ä¿æ²¡æœ‰é‡å¤ä½¿ç”¨ç›¸åŒçš„ nonce å€¼
4. éªŒè¯é’±åŒ…å¯†é’¥æ˜¯å¦å¯¹åº”æ­£ç¡®çš„å…¬é’¥

### äº¤æ˜“å¤±è´¥

**ç—‡çŠ¶**ï¼š`Transaction failed` æˆ– `Slippage tolerance exceeded`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å¢åŠ æ»‘ç‚¹å®¹å¿åº¦ï¼ˆslippage_basis_pointsï¼‰
2. æ£€æŸ¥è¾“å…¥é‡‘é¢æ˜¯å¦åˆç†
3. ç¡®è®¤ä»£å¸åˆçº¦åœ°å€æ­£ç¡®
4. ä½¿ç”¨ `simulate: true` æ¨¡å¼å…ˆè¿›è¡Œäº¤æ˜“æ¨¡æ‹Ÿ

**Section sources**
- [examples/cli_trading/README.md](file://examples/cli_trading/README.md#L172-L181)
- [src/lib.rs](file://src/lib.rs#L360-L368)

## å®Œæ•´ç¤ºä¾‹æµç¨‹

ä»¥ä¸‹æ˜¯ä»é¡¹ç›®åˆ›å»ºåˆ°æˆåŠŸæ‰§è¡Œä¸€ç¬” PumpFun ä»£å¸äº¤æ˜“çš„å®Œæ•´æµç¨‹ï¼š

### 1. åˆ›å»ºæ–°é¡¹ç›®

```bash
cargo new pumpfun_trader
cd pumpfun_trader
```

### 2. æ·»åŠ ä¾èµ–

åœ¨ `Cargo.toml` ä¸­æ·»åŠ ï¼š

```toml
[dependencies]
sol-trade-sdk = "3.3.6"
tokio = { version = "1.42.0", features = ["full"] }
```

### 3. ç¼–å†™ä¸»ç¨‹åº

```rust
use sol_trade_sdk::{
    common::{TradeConfig, GasFeeStrategy},
    swqos::SwqosConfig,
    SolanaTrade, TradeBuyParams, DexType, TradeTokenType,
};
use solana_commitment_config::CommitmentConfig;
use solana_sdk::{pubkey::Pubkey, signature::Keypair};
use std::sync::Arc;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    // åˆå§‹åŒ–å®¢æˆ·ç«¯
    let payer = Keypair::from_base58_string("your_private_key");
    let rpc_url = "https://api.mainnet-beta.solana.com".to_string();
    let commitment = CommitmentConfig::processed();
    let swqos_configs = vec![SwqosConfig::Default(rpc_url.clone())];
    let trade_config = TradeConfig::new(rpc_url, swqos_configs, commitment);
    let client = SolanaTrade::new(Arc::new(payer), trade_config).await;

    // é…ç½® Gas ç­–ç•¥
    let gas_fee_strategy = GasFeeStrategy::new();
    gas_fee_strategy.set_global_fee_strategy(150000,150000, 500000,500000, 0.001, 0.001, 256 * 1024, 0);

    // æ‰§è¡Œè´­ä¹°
    let buy_params = TradeBuyParams {
        dex_type: DexType::PumpFun,
        input_token_type: TradeTokenType::SOL,
        mint: Pubkey::from_str("PUMP_TOKEN_MINT")?,
        input_token_amount: 100000000, // 0.1 SOL
        slippage_basis_points: Some(500),
        recent_blockhash: None,
        extension_params: DexParamEnum::PumpFun(pumpfun_params),
        wait_transaction_confirmed: true,
        gas_fee_strategy,
        simulate: false,
        ..Default::default()
    };

    match client.buy(buy_params).await {
        Ok((true, signatures, _)) => {
            println!("ğŸ‰ äº¤æ˜“æˆåŠŸ! ç­¾å: {:?}", signatures);
        }
        _ => {
            println!("âŒ äº¤æ˜“å¤±è´¥");
        }
    }

    Ok(())
}
```

### 4. è¿è¡Œäº¤æ˜“

```bash
cargo run
```

**Section sources**
- [examples/cli_trading/src/main.rs](file://examples/cli_trading/src/main.rs#L1-L800)
- [examples/trading_client/src/main.rs](file://examples/trading_client/src/main.rs#L1-L41)